function toggleLoading(t){const n=document.getElementsByClassName("lbcg-parent");for(let e=0;e<n.length;e++)!0===t?n[e].classList.add("lbcg-loading"):n[e].classList.remove("lbcg-loading")}function checkSmallWordInGrid(t){let n=0,c=0,a=!1;for(let e=0;e<t.length;e++)t[e].innerHTML.length>c&&(c=t[e].innerHTML.length,n=e),(t[e].offsetHeight>t[e].parentNode.offsetHeight||t[e].scrollWidth>t[e].offsetWidth)&&(a=!0);let e=!1,r=getComputedStyle(document.documentElement).getPropertyValue("--lbcg-grid-font-size"),o=t[0].parentNode.offsetHeight,l=.71*o;for(r=parseFloat(r.split("px")[0]);t[n].offsetHeight<=t[n].parentNode.offsetHeight&&t[n].scrollWidth<=t[n].offsetWidth&&r<l&&r<lbcgFontSize;)e=!0,document.documentElement.style.setProperty("--lbcg-grid-font-size",(r+=.5)+"px");return e?(document.documentElement.style.setProperty("--lbcg-grid-font-size",r-.5+"px"),!0):a}function isSingleWordWrapped(e,t){return-1===e.innerText.trim().indexOf(" ")&&e.offsetHeight>1.5*t}function checkWrapWordInGrid(r,o){if(o){o=document.getElementById("lbcg-wrap-words-check");let t;t=o?o.checked:"break-word"===getComputedStyle(document.documentElement).getPropertyValue("--lbcg-grid-wrap-words").trim();let n=!1,c=getComputedStyle(document.documentElement).getPropertyValue("--lbcg-grid-font-size"),e=r[0].parentNode.offsetHeight,a=.71*e;c=parseFloat(c.split("px")[0]);for(let e=0;e<r.length;e++){for(;r[e].offsetHeight>r[e].parentNode.offsetHeight||r[e].scrollWidth>r[e].offsetWidth||c>a;)document.documentElement.style.setProperty("--lbcg-grid-font-size",(c-=.5)+"px"),n=!0;for(;t&&isSingleWordWrapped(r[e],c);)document.documentElement.style.setProperty("--lbcg-grid-font-size",(c-=.5)+"px"),n=!0;setTimeout(()=>{for(;r[e].offsetHeight>r[e].parentNode.offsetHeight||r[e].scrollWidth>r[e].offsetWidth||c>a;)document.documentElement.style.setProperty("--lbcg-grid-font-size",(c-=.5)+"px"),n=!0;for(;t&&isSingleWordWrapped(r[e],c);)document.documentElement.style.setProperty("--lbcg-grid-font-size",(c-=.5)+"px"),n=!0},10)}return n}{let e=!1,t=getComputedStyle(document.documentElement).getPropertyValue("--lbcg-grid-font-size"),n=r[0].parentNode.offsetHeight,c=.71*n;for(t=parseFloat(t.split("px")[0]);t>c;)document.documentElement.style.setProperty("--lbcg-grid-font-size",(t-=.5)+"px"),e=!0;return e}}function checkGridFontSize(){toggleLoading(!0);var e=document.getElementsByName("bingo_card_type")[0].value;if("1-75"!==e&&"1-90"!==e){const o=document.getElementById("lbcg-body-content"),l=document.getElementsByClassName("lbcg-card-text");if(o&&l.length){var a=o.value.split("\n"),r=Math.ceil(a.length/l.length);window.lbcgFontSize=100;let e,t,n,c;for(t=0;t<r;t++){for(e=0;e<l.length;e++)(n=t*l.length+e)in a&&(l[e].innerHTML=a[n]);c=checkSmallWordInGrid(l),checkWrapWordInGrid(l,c),window.lbcgFontSize=parseFloat(getComputedStyle(document.documentElement).getPropertyValue("--lbcg-grid-font-size").split("px")[0])}for(e=0;e<l.length;e++)l[e].innerHTML=a[e];document.getElementsByName("lbcg_font_size")[0].value=window.lbcgFontSize}}toggleLoading(!1)}document.addEventListener("DOMContentLoaded",function(){function d(){const e=document.getElementById("lbcg-body-content").value.split("\n"),t=document.getElementById("lbcg-grid-size").value,n=document.getElementsByName("bingo_card_type")[0].value;if("1-75"===n||"1-90"===n)return"";let c=25;return"3x3"===t?c=9:"4x4"===t&&(c=16),e.filter(e=>""!==e).length<c?"Please fill minimum "+c+" words/emojis or numbers, each in new line.":""}toggleLoading(!0),document.addEventListener("click",function(t){if(t.target.matches(".remove-bc-image")){t.preventDefault();var e=t.target.getAttribute("data-bct");document.getElementById("bc-"+e+"-image").value="",document.getElementsByName("bc_"+e+"[remove_image]")[0].value=1,document.documentElement.style.setProperty("--lbcg-"+e+"-bg-image","none")}else if(t.target.matches("#lbcg-view-all-cards")){t.preventDefault();const n=document.getElementById("lbcg-cards-custom-count");e=parseInt(n.value);(isNaN(e)||e<=0)&&(n.disabled=!0),document.forms["lbcg-view-all-cards-form"].submit(),n.disabled=!1}else if(t.target.matches("div.lbcg-card-col")||t.target.matches("span.lbcg-card-text")||t.target.matches("span.lbcg-card-text img")){let e=t.target;t.target.matches("span.lbcg-card-text")?e=e.parentNode:t.target.matches("span.lbcg-card-text img")&&(e=e.parentNode.parentNode),e.classList.contains("lbcg-card-col-checked")?e.classList.remove("lbcg-card-col-checked"):e.children[0].hasChildNodes()&&e.classList.add("lbcg-card-col-checked")}else if(t.target.matches("span.lbcg-sidebar-arrow")){const c=t.target.parentNode.parentNode;c.classList.contains("collapsed")?c.classList.remove("collapsed"):c.classList.add("collapsed")}}),document.addEventListener("input",function(t){if(t.target.matches("#lbcg-title"))document.querySelector("div.lbcg-card-header span.lbcg-card-header-text").innerHTML=t.target.value;else if(t.target.matches("#lbcg-body-content")){toggleLoading(!0);var n=d();const c=t.target.value.split("\n"),a=document.querySelectorAll("div.lbcg-card-body-grid span.lbcg-card-text"),r=document.getElementById("lbcg-free-space-check").checked;for(let e=1,t=1;e<=a.length;t++)Math.round(a.length/2)===e&&r?(a[e-1].innerHTML=LBCG.freeSquareWord,e++):(""!==n||void 0!==c[t-1]&&""!==c[t-1])&&(a[e-1].innerHTML=void 0===c[t-1]?"":c[t-1],e++);checkGridFontSize()}else if(t.target.matches("#lbcg-subtitle")){const o=""!==t.target.value?t.target.value.split(""):[];let e="";switch(o.length){case 4:case 3:e="<span></span>";break;case 2:case 1:e="<span></span><span></span>"}document.getElementsByClassName("lbcg-card-subtitle-text")[0].innerHTML=e+(o.length?"<span>"+o.join("</span><span>")+"</span>":"")+e}}),document.addEventListener("change",function(t){if(t.target.matches("#lbcg-grid-size")){const n=document.getElementById("lbcg-free-space-check");"4x4"===t.target.value?(window.LBCIncludeFreeSpace=n.checked,n.checked=!1,n.parentNode.style.display="none"):(n.checked=window.LBCIncludeFreeSpace,n.parentNode.style.display="");let e;e=document.getElementById("lbcg-wrap-words-check").checked?1:"1-90"===document.getElementsByName("bingo_card_type")[0].value?"33.3px":"3x3"===t.target.value?"102px":"4x4"===t.target.value?"76.25px":"60.8px";const c=document.getElementById("content-items-count");c&&(c.innerText="3x3"===t.target.value?9:"4x4"===t.target.value?16:25);const a=document.getElementsByName("bingo_grid_size")[0];a&&(a.value=t.target.value),document.documentElement.style.setProperty("--lbcg-grid-line-height",e),function(){var n=d(),e=document.getElementById("lbcg-grid-size").value[0],c=document.getElementById("lbcg-body-content").value.split("\n"),a=document.getElementById("lbcg-free-space-check").checked,r=e**2;let o="";for(let e=1,t=1;e<=r;t++)(""!==n||void 0!==c[t-1]&&""!==c[t-1])&&(o+='<div class="lbcg-card-col"><span class="lbcg-card-text">'+(Math.round(r/2)===e&&a?LBCG.freeSquareWord:void 0===c[t-1]?"":c[t-1])+"</span></div>",e++);const t=document.querySelector("div.lbcg-card-body-grid"),l=Math.sqrt(document.querySelectorAll("div.lbcg-card-body-grid span.lbcg-card-text").length);t.classList.remove("lbcg-grid-"+l),t.classList.add("lbcg-grid-"+e),t.innerHTML=o}(),checkGridFontSize()}else if(t.target.matches("#lbcg-font"))document.documentElement.style.setProperty("--lbcg-header-font-family",LBCG.fonts[t.target.value].name+", sans-serif"),document.documentElement.style.setProperty("--lbcg-grid-font-family",LBCG.fonts[t.target.value].name+", sans-serif"),checkGridFontSize();else if(t.target.matches("#lbcg-free-space-check"))!function(e){const t=document.querySelectorAll("div.lbcg-card-body-grid span.lbcg-card-text"),n=Math.round(t.length/2)-1;e?t[n].innerHTML=LBCG.freeSquareWord:(e=document.getElementById("lbcg-body-content").value.split("\n"),t[n].innerHTML="1-75"===document.getElementsByName("bingo_card_type")[0].value?33:e[n])}(t.target.checked);else if(t.target.matches("#lbcg-cards-custom-count")){var e=parseInt(t.target.value);document.getElementById("lbcg-cards-count").disabled=0<e}else if(t.target.matches("#lbcg-wrap-words-check")){let e;e=t.target.checked?1:(t=document.getElementById("lbcg-grid-size").value,"1-90"===document.getElementsByName("bingo_card_type")[0].value?"33.3px":"3x3"===t?"102px":"4x4"===t?"76.25px":"60.8px"),document.documentElement.style.setProperty("--lbcg-grid-line-height",e),checkGridFontSize()}}),document.addEventListener("submit",function(e){if(e.target.matches("#lbcg-bc-generation")){e.preventDefault(),toggleLoading(!0);var t=d();if(""!==t)return alert(t),!1;t=new FormData(e.target);const n=new XMLHttpRequest;n.onreadystatechange=function(){if(4===n.readyState&&200===n.status){const e=JSON.parse(n.responseText);!0===e.success?location.replace(e.redirectTo):(alert(e.errors.join("\n")),toggleLoading(!1))}},n.open(e.target.method,LBCG.ajaxUrl,!0),n.send(t)}else if(e.target.matches("#lbcg-bc-invitation")){e.preventDefault(),toggleLoading(!0);t=new FormData(e.target);const c=new XMLHttpRequest;c.onreadystatechange=function(){if(4===c.readyState&&200===c.status){const e=JSON.parse(c.responseText);!0===e.success?0<e.failedInvites.length?alert("Invitation finished. Failed to invite them: "+e.failedInvites.join(", ")+"."):alert("Invitation finished successfully."):alert(e.errors.join("\n")),toggleLoading(!1)}},c.open(e.target.method,LBCG.ajaxUrl,!0),c.send(t)}}),document.addEventListener("change",function(e){var t,n,c,a;e.target.matches(".bc-font-color")?(t=e.target.getAttribute("data-bct"),document.documentElement.style.setProperty("--lbcg-"+t+"-text-color",e.target.value)):e.target.matches(".bc-border-color")?(t=e.target.getAttribute("data-bct"),document.documentElement.style.setProperty("--lbcg-"+t+"-border-color",e.target.value)):e.target.matches(".bc-color")?(n=e.target.getAttribute("data-bct"),document.documentElement.style.setProperty("--lbcg-"+n+"-bg-color",e.target.value)):e.target.matches(".bc-image")?(n=e.target.getAttribute("data-bct"),document.getElementsByName("bc_"+n+"[remove_image]")[0].value="0",document.documentElement.style.setProperty("--lbcg-"+n+"-bg-image","url("+URL.createObjectURL(e.target.files[0])+")")):e.target.matches(".bc-pos")?(c=e.target.getAttribute("data-bct"),document.documentElement.style.setProperty("--lbcg-"+c+"-bg-pos",e.target.value)):e.target.matches(".bc-repeat")?(c=e.target.getAttribute("data-bct"),document.documentElement.style.setProperty("--lbcg-"+c+"-bg-repeat",e.target.value)):e.target.matches(".bc-size")?(a=e.target.getAttribute("data-bct"),document.documentElement.style.setProperty("--lbcg-"+a+"-bg-size",e.target.value)):e.target.matches(".bc-opacity")&&(a=e.target.getAttribute("data-bct"),document.documentElement.style.setProperty("--lbcg-"+a+"-bg-opacity",e.target.value/100))})}),window.onload=checkGridFontSize;