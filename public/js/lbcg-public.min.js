function toggleLoading(t){const c=document.getElementsByClassName("lbcg-parent");for(let e=0;e<c.length;e++)!0===t?c[e].classList.add("lbcg-loading"):c[e].classList.remove("lbcg-loading")}function checkSmallWordInGrid(t){let c=0,n=0,r=!1;for(let e=0;e<t.length;e++)t[e].innerHTML.length>n&&(n=t[e].innerHTML.length,c=e),t[e].offsetHeight>t[e].parentNode.offsetHeight&&(r=!0);let e=!1,a=getComputedStyle(document.documentElement).getPropertyValue("--lbcg-grid-font-size"),l=t[0].parentNode.offsetHeight,o=.71*l;for(a=parseFloat(a.split("px")[0]);t[c].offsetHeight<=t[c].parentNode.offsetHeight&&a<o;)e=!0,document.documentElement.style.setProperty("--lbcg-grid-font-size",(a+=.5)+"px");return e?(document.documentElement.style.setProperty("--lbcg-grid-font-size",a-.5+"px"),!0):r}function isSingleWordWrapped(e,t){return-1===e.innerText.trim().indexOf(" ")&&e.offsetHeight>1.5*t}function checkWrapWordInGrid(a,l){if(l){l=document.getElementById("lbcg-wrap-words-check");let t;t=l?l.checked:"break-word"===getComputedStyle(document.documentElement).getPropertyValue("--lbcg-grid-wrap-words").trim();let c=!1,n=getComputedStyle(document.documentElement).getPropertyValue("--lbcg-grid-font-size"),e=a[0].parentNode.offsetHeight,r=.71*e;n=parseFloat(n.split("px")[0]);for(let e=0;e<a.length;e++){for(;a[e].offsetHeight>a[e].parentNode.offsetHeight+.1||n>r;)document.documentElement.style.setProperty("--lbcg-grid-font-size",(n-=.5)+"px"),c=!0;for(;t&&isSingleWordWrapped(a[e],n);)document.documentElement.style.setProperty("--lbcg-grid-font-size",(n-=.5)+"px"),c=!0;setTimeout(()=>{for(;a[e].offsetHeight>a[e].parentNode.offsetHeight+.1||n>r;)document.documentElement.style.setProperty("--lbcg-grid-font-size",(n-=.5)+"px"),c=!0;for(;t&&isSingleWordWrapped(a[e],n);)document.documentElement.style.setProperty("--lbcg-grid-font-size",(n-=.5)+"px"),c=!0},10)}return c}{let e=!1,t=getComputedStyle(document.documentElement).getPropertyValue("--lbcg-grid-font-size"),c=a[0].parentNode.offsetHeight,n=.71*c;for(t=parseFloat(t.split("px")[0]);t>n;)document.documentElement.style.setProperty("--lbcg-grid-font-size",(t-=.5)+"px"),e=!0;return e}}function checkGridFontSize(){toggleLoading(!0);var e=document.getElementsByName("bingo_card_type")[0].value;"1-75"!==e&&"1-90"!==e&&checkWrapWordInGrid(e=document.getElementsByClassName("lbcg-card-text"),checkSmallWordInGrid(e)),toggleLoading(!1)}document.addEventListener("DOMContentLoaded",function(){function d(){const e=document.getElementById("lbcg-body-content").value.split("\n"),t=document.getElementById("lbcg-grid-size").value,c=document.getElementsByName("bingo_card_type")[0].value;if("1-75"===c||"1-90"===c)return"";let n=25;return"3x3"===t?n=9:"4x4"===t&&(n=16),e.filter(e=>""!==e).length<n?"Please fill minimum "+n+" words/emojis or numbers, each in new line.":""}toggleLoading(!0),document.addEventListener("click",function(t){if(t.target.matches("div.lbcg-sidebar-header")||t.target.matches("a.lbcg-sidebar-btn")){t.preventDefault();let e=t.target.parentNode;t.target.matches("a.lbcg-sidebar-btn")&&(e=e.parentNode),e.classList.contains("collapsed")?e.classList.remove("collapsed"):e.classList.add("collapsed")}else if(t.target.matches(".remove-bc-image")){t.preventDefault();var e=t.target.getAttribute("data-bct");document.getElementById("bc-"+e+"-image").value="",document.getElementsByName("bc_"+e+"[remove_image]")[0].value=1,document.documentElement.style.setProperty("--lbcg-"+e+"-bg-image","none")}else if(t.target.matches("#lbcg-view-all-cards")){t.preventDefault();const c=document.getElementById("lbcg-cards-custom-count");e=parseInt(c.value);(isNaN(e)||e<=0)&&(c.disabled=!0),document.forms["lbcg-view-all-cards-form"].submit(),c.disabled=!1}else if(t.target.matches("div.lbcg-card-col")||t.target.matches("span.lbcg-card-text")||t.target.matches("span.lbcg-card-text img")){let e=t.target;t.target.matches("span.lbcg-card-text")?e=e.parentNode:t.target.matches("span.lbcg-card-text img")&&(e=e.parentNode.parentNode),e.classList.contains("lbcg-card-col-checked")?e.classList.remove("lbcg-card-col-checked"):e.classList.add("lbcg-card-col-checked")}}),document.addEventListener("input",function(e){if(e.target.matches("#lbcg-title"))document.querySelector("div.lbcg-card-header span.lbcg-card-header-text").innerHTML=e.target.value;else if(e.target.matches("#lbcg-body-content")){toggleLoading(!0);var c=d();const n=e.target.value.split("\n"),r=document.querySelectorAll("div.lbcg-card-body-grid span.lbcg-card-text"),a=document.getElementById("lbcg-free-space-check").checked;for(let e=1,t=1;e<=r.length;t++)Math.round(r.length/2)===e&&a?(r[e-1].innerHTML=LBCG.freeSquareWord,e++):(""!==c||void 0!==n[t-1]&&""!==n[t-1])&&(r[e-1].innerHTML=void 0===n[t-1]?"":n[t-1],e++);checkGridFontSize()}}),document.addEventListener("change",function(t){if(t.target.matches("#lbcg-grid-size")){const n=document.getElementById("lbcg-free-space-check");"4x4"===t.target.value?(window.LBCIncludeFreeSpace=n.checked,n.checked=!1,n.parentNode.style.display="none"):(n.checked=window.LBCIncludeFreeSpace,n.parentNode.style.display="");let e;e=document.getElementById("lbcg-wrap-words-check").checked?1:"1-90"===document.getElementsByName("bingo_card_type")[0].value?"33.3px":"3x3"===t.target.value?"102px":"4x4"===t.target.value?"76.25px":"60.8px";const r=document.getElementById("content-items-count");r&&(r.innerText="3x3"===t.target.value?9:"4x4"===t.target.value?16:25);const a=document.getElementsByName("bingo_grid_size")[0];a&&(a.value=t.target.value),document.documentElement.style.setProperty("--lbcg-grid-line-height",e),function(){var c=d(),e=document.getElementById("lbcg-grid-size").value[0],n=document.getElementById("lbcg-body-content").value.split("\n"),r=document.getElementById("lbcg-free-space-check").checked,a=e**2;let l="";for(let e=1,t=1;e<=a;t++)(""!==c||void 0!==n[t-1]&&""!==n[t-1])&&(l+='<div class="lbcg-card-col"><span class="lbcg-card-text">'+(Math.round(a/2)===e&&r?LBCG.freeSquareWord:void 0===n[t-1]?"":n[t-1])+"</span></div>",e++);const t=document.querySelector("div.lbcg-card-body-grid"),o=Math.sqrt(document.querySelectorAll("div.lbcg-card-body-grid span.lbcg-card-text").length);t.classList.remove("lbcg-grid-"+o),t.classList.add("lbcg-grid-"+e),t.innerHTML=l}(),checkGridFontSize()}else if(t.target.matches("#lbcg-font"))document.documentElement.style.setProperty("--lbcg-header-font-family",LBCG.fonts[t.target.value].name+", sans-serif"),document.documentElement.style.setProperty("--lbcg-grid-font-family",LBCG.fonts[t.target.value].name+", sans-serif"),checkGridFontSize();else if(t.target.matches("#lbcg-free-space-check"))!function(e){const t=document.querySelectorAll("div.lbcg-card-body-grid span.lbcg-card-text"),c=Math.round(t.length/2)-1;e?t[c].innerHTML=LBCG.freeSquareWord:(e=document.getElementById("lbcg-body-content").value.split("\n"),t[c].innerHTML="1-75"===document.getElementsByName("bingo_card_type")[0].value?33:e[c])}(t.target.checked);else if(t.target.matches("#lbcg-cards-custom-count")){var c=parseInt(t.target.value);document.getElementById("lbcg-cards-count").disabled=0<c}else if(t.target.matches("#lbcg-wrap-words-check")){let e;e=t.target.checked?1:(c=document.getElementById("lbcg-grid-size").value,"1-90"===document.getElementsByName("bingo_card_type")[0].value?"33.3px":"3x3"===c?"102px":"4x4"===c?"76.25px":"60.8px"),document.documentElement.style.setProperty("--lbcg-grid-line-height",e),document.documentElement.style.setProperty("--lbcg-grid-wrap-words",t.target.checked?"break-word":"anywhere"),checkGridFontSize()}}),document.querySelectorAll("label.lbcg-label--single input.lbcg-input").forEach(function(e){e.addEventListener("input",function(e){const t=e.target,c=document.querySelectorAll("div.lbcg-card-subtitle span.lbcg-card-subtitle-text span"),n=t.getAttribute("id"),r=n.replace("lbcg-subtitle-","")-1;c[r].innerHTML=t.value})}),document.addEventListener("submit",function(e){if(e.target.matches("#lbcg-bc-generation")){e.preventDefault(),toggleLoading(!0);var t=d();if(""!==t)return alert(t),!1;t=new FormData(e.target);const c=new XMLHttpRequest;c.onreadystatechange=function(){if(4===c.readyState&&200===c.status){const e=JSON.parse(c.responseText);!0===e.success?location.replace(e.redirectTo):(alert(e.errors.join("\n")),toggleLoading(!1))}},c.open(e.target.method,LBCG.ajaxUrl,!0),c.send(t)}else if(e.target.matches("#lbcg-bc-invitation")){e.preventDefault(),toggleLoading(!0);t=new FormData(e.target);const n=new XMLHttpRequest;n.onreadystatechange=function(){if(4===n.readyState&&200===n.status){const e=JSON.parse(n.responseText);!0===e.success?0<e.failedInvites.length?alert("Invitation finished. Failed to invite them: "+e.failedInvites.join(", ")+"."):alert("Invitation finished successfully."):alert(e.errors.join("\n")),toggleLoading(!1)}},n.open(e.target.method,LBCG.ajaxUrl,!0),n.send(t)}}),document.addEventListener("change",function(e){var t,c,n,r;e.target.matches(".bc-font-color")?(t=e.target.getAttribute("data-bct"),document.documentElement.style.setProperty("--lbcg-"+t+"-text-color",e.target.value)):e.target.matches(".bc-border-color")?(t=e.target.getAttribute("data-bct"),document.documentElement.style.setProperty("--lbcg-"+t+"-border-color",e.target.value)):e.target.matches(".bc-color")?(c=e.target.getAttribute("data-bct"),document.documentElement.style.setProperty("--lbcg-"+c+"-bg-color",e.target.value)):e.target.matches(".bc-image")?(c=e.target.getAttribute("data-bct"),document.getElementsByName("bc_"+c+"[remove_image]")[0].value="0",document.documentElement.style.setProperty("--lbcg-"+c+"-bg-image","url("+URL.createObjectURL(e.target.files[0])+")")):e.target.matches(".bc-pos")?(n=e.target.getAttribute("data-bct"),document.documentElement.style.setProperty("--lbcg-"+n+"-bg-pos",e.target.value)):e.target.matches(".bc-repeat")?(n=e.target.getAttribute("data-bct"),document.documentElement.style.setProperty("--lbcg-"+n+"-bg-repeat",e.target.value)):e.target.matches(".bc-size")?(r=e.target.getAttribute("data-bct"),document.documentElement.style.setProperty("--lbcg-"+r+"-bg-size",e.target.value)):e.target.matches(".bc-opacity")&&(r=e.target.getAttribute("data-bct"),document.documentElement.style.setProperty("--lbcg-"+r+"-bg-opacity",e.target.value/100))})}),window.onload=checkGridFontSize;