function toggleLoading(t){const n=document.getElementsByClassName("lbcg-parent");for(let e=0;e<n.length;e++)!0===t?n[e].classList.add("lbcg-loading"):n[e].classList.remove("lbcg-loading")}function setCardCheckedState(){var e=document.getElementById("bc-pn");if(e){var t=JSON.parse(localStorage.getItem("pn-"+e.value))||[];for(const n in t){const c=document.querySelector('div.lbcg-card-col[data-key="'+n+'"]');c&&t[n]&&c.classList.add("lbcg-card-col-checked")}}}function checkSmallWordInGrid(t){let n=0,c=0,a=!1;for(let e=0;e<t.length;e++)t[e].innerHTML.length>c&&(c=t[e].innerHTML.length,n=e),(t[e].offsetHeight>t[e].parentNode.offsetHeight||t[e].scrollWidth>t[e].offsetWidth)&&(a=!0);let e=!1,r=getComputedStyle(document.documentElement).getPropertyValue("--lbcg-grid-font-size"),l=t[0].parentNode.offsetHeight,o=.71*l,s,d;for(r=parseFloat(r.split("px")[0]);t[n].offsetHeight<=t[n].parentNode.offsetHeight&&t[n].scrollWidth<=t[n].offsetWidth&&r<o&&r<lbcgFontSize;)if(s=t[n].offsetHeight,d=t[n].scrollWidth,document.documentElement.style.setProperty("--lbcg-grid-font-size",(r+=.5)+"px"),e=!0,s===t[n].offsetHeight&&d===t[n].scrollWidth||r<0){document.documentElement.style.setProperty("--lbcg-grid-font-size",(r-=.5)+"px");break}return e?(document.documentElement.style.setProperty("--lbcg-grid-font-size",r-.5+"px"),!0):a}function isSingleWordWrapped(e,t){return-1===e.innerText.trim().indexOf(" ")&&e.offsetHeight>1.5*t}function checkWrapWordInGrid(o,s){if(s){s=document.getElementById("lbcg-wrap-words-check");let t;t=s?s.checked:"break-word"===getComputedStyle(document.documentElement).getPropertyValue("--lbcg-grid-wrap-words").trim();let n=!1,c=getComputedStyle(document.documentElement).getPropertyValue("--lbcg-grid-font-size"),e=o[0].parentNode.offsetHeight,a=.71*e,r,l;c=parseFloat(c.split("px")[0]);for(let e=0;e<o.length;e++){for(;o[e].offsetHeight>o[e].parentNode.offsetHeight||o[e].scrollWidth>o[e].offsetWidth||c>a;)if(r=o[e].offsetHeight,l=o[e].scrollWidth,document.documentElement.style.setProperty("--lbcg-grid-font-size",(c-=.5)+"px"),n=!0,r===o[e].offsetHeight&&l===o[e].scrollWidth||c<0){document.documentElement.style.setProperty("--lbcg-grid-font-size",(c+=.5)+"px");break}for(;t&&isSingleWordWrapped(o[e],c);)document.documentElement.style.setProperty("--lbcg-grid-font-size",(c-=.5)+"px"),n=!0;setTimeout(()=>{for(;o[e].offsetHeight>o[e].parentNode.offsetHeight||o[e].scrollWidth>o[e].offsetWidth||c>a;)if(r=o[e].offsetHeight,l=o[e].scrollWidth,document.documentElement.style.setProperty("--lbcg-grid-font-size",(c-=.5)+"px"),n=!0,r===o[e].offsetHeight&&l===o[e].scrollWidth||c<0){document.documentElement.style.setProperty("--lbcg-grid-font-size",(c+=.5)+"px");break}for(;t&&isSingleWordWrapped(o[e],c);)document.documentElement.style.setProperty("--lbcg-grid-font-size",(c-=.5)+"px"),n=!0},10)}return n}{let e=!1,t=getComputedStyle(document.documentElement).getPropertyValue("--lbcg-grid-font-size"),n=o[0].parentNode.offsetHeight,c=.71*n;for(t=parseFloat(t.split("px")[0]);t>c;)document.documentElement.style.setProperty("--lbcg-grid-font-size",(t-=.5)+"px"),e=!0;return e}}function checkGridFontSize(){toggleLoading(!0);var e=document.getElementsByName("bingo_card_type")[0].value;if("1-75"!==e&&"1-90"!==e){const l=document.getElementById("lbcg-body-content"),o=document.getElementsByClassName("lbcg-card-text");if(l&&o.length){var a=l.value.split("\n"),r=Math.ceil(a.length/o.length);window.lbcgFontSize=100;let e,t,n,c;for(t=0;t<r;t++){for(e=0;e<o.length;e++)(n=t*o.length+e)in a&&(o[e].innerHTML=a[n]);c=checkSmallWordInGrid(o),checkWrapWordInGrid(o,c),window.lbcgFontSize=parseFloat(getComputedStyle(document.documentElement).getPropertyValue("--lbcg-grid-font-size").split("px")[0])}for(e=0;e<o.length;e++)o[e].innerHTML=a[e];document.getElementsByName("lbcg_font_size")[0].value=window.lbcgFontSize}}toggleLoading(!1)}function checkLFromHEX(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);r=parseInt(t[1],16)/255,g=parseInt(t[2],16)/255,b=parseInt(t[3],16)/255;e=Math.max(r,g,b),t=Math.min(r,g,b);let n,c,a=(e+t)/2;if(e===t)n=c=0;else{var l=e-t;switch(c=.5<a?l/(2-e-t):l/(e+t),e){case r:n=(g-b)/l+(g<b?6:0);break;case g:n=(b-r)/l+2;break;case b:n=(r-g)/l+4}n/=6}return{h:Math.round(240*n),s:Math.round(240*c),l:Math.round(240*a)}}function HSLToHex(e,t,n){t/=240,n/=240;let c=(1-Math.abs(2*n-1))*t,a=c*(1-Math.abs(e/40%2-1)),r=n-c/2,l=0,o=0,s=0;return 0<=e&&e<40?(l=c,o=a,s=0):40<=e&&e<80?(l=a,o=c,s=0):80<=e&&e<120?(l=0,o=c,s=a):120<=e&&e<160?(l=0,o=a,s=c):160<=e&&e<200?(l=a,o=0,s=c):200<=e&&e<=240&&(l=c,o=0,s=a),l=Math.round(255*(l+r)).toString(16),o=Math.round(255*(o+r)).toString(16),s=Math.round(255*(s+r)).toString(16),1===l.length&&(l="0"+l),1===o.length&&(o="0"+o),1===s.length&&(s="0"+s),"#"+l+o+s}function addEventsForWordsPercentsInputs(){document.querySelectorAll(".lbcg-word-percent").forEach(e=>{e.addEventListener("focus",function(e){e.target.oldValue=e.target.value}),e.addEventListener("blur",function(t){if(void 0!==t.target.oldValue)try{100<t.target.value?t.target.value=100:t.target.value<0&&(t.target.value=0);const n=t.target.oldValue-t.target.value;if(t.target.value=parseFloat(t.target.value).toFixed(2),0!=n){const e=t.target.getAttribute("data-wpi"),c=document.querySelectorAll('input.lbcg-word-percent:not([data-wpi="'+e+'"])'),a=[...c].map(e=>parseFloat(e.value)),r=a.reduce((e,t)=>e+t,0);0!==r&&c.forEach(e=>{e.value=(e.value*(1+n/r)).toFixed(2)})}}catch(e){t.target.value=t.target.oldValue}})})}function setEvenDistributionContent(){try{var e=document.querySelectorAll("#lbcg-even-distribution-content .lbcg-word-percent");let n=[];e.length&&(n=[...e].map(e=>e.value));var t=document.querySelectorAll("#lbcg-even-distribution-content .lbcg-input-wrap--words-distribution");t.length&&[...t].map(e=>e.remove());const a=document.getElementById("lbcg-body-content").value.split("\n").filter(e=>e),r=(100/a.length).toFixed(2);var c=a.map((e,t)=>`<div class="lbcg-input-wrap-in lbcg-input-wrap--words-distribution">
    <label class="lbcg-label lbcg-label--single">
        <input class="lbcg-input" type="text" value="${e.lcToHtmlEntities()}" readonly/>
    </label>
    <label class="lbcg-label lbcg-label--single">
        <input class="lbcg-input lbcg-word-percent" name="bcc_words_percents[]" type="number" min="0" max="100" step="0.01" value="${n.length?n[t]:r}" data-wpi="${t}"/>
    </label>
</div>`).join("");const l=document.getElementById("lbcg-even-distribution-content");return l.innerHTML=l.innerHTML+c,addEventsForWordsPercentsInputs(),!0}catch(e){return console.error(e.message),!1}}function setWordsFromEvenDistributionContent(){try{return!0}catch(e){return console.error(e.message),!1}}String.prototype.lcToHtmlEntities=function(){return this.replace(/./gm,function(e){return e.match(/[a-z0-9\s]+/i)?e:"&#"+e.charCodeAt(0)+";"})},document.addEventListener("DOMContentLoaded",function(){function s(){const e=document.getElementById("lbcg-body-content").value.split("\n"),t=document.getElementById("lbcg-grid-size").value,n=document.getElementsByName("bingo_card_type")[0].value;if("1-75"===n||"1-90"===n)return"";let c=25;return"3x3"===t?c=9:"4x4"===t&&(c=16),e.filter(e=>""!==e).length<c?"Please fill minimum "+c+" words/emojis or numbers, each in new line.":""}checkGridFontSize(),setCardCheckedState(),document.addEventListener("click",function(n){if(n.target.matches(".bc-font-color")){var e=checkLFromHEX(n.target.value);e.l<24&&(n.target.value=HSLToHex(e.h,e.s,120))}else if(n.target.matches(".bc-border-color")){e=checkLFromHEX(n.target.value);e.l<24&&(n.target.value=HSLToHex(e.h,e.s,120))}else if(n.target.matches(".bc-color")){var t=checkLFromHEX(n.target.value);t.l<24&&(n.target.value=HSLToHex(t.h,t.s,120))}else if(n.target.matches(".remove-bc-image")){n.preventDefault();t=n.target.getAttribute("data-bct");document.getElementById("bc-"+t+"-image").value="",document.getElementsByName("bc_"+t+"[remove_image]")[0].value=1,document.documentElement.style.setProperty("--lbcg-"+t+"-bg-image","none")}else if(n.target.matches("#lbcg-view-all-cards")){n.preventDefault();const a=document.getElementById("lbcg-cards-custom-count");var c=parseInt(a.value);(isNaN(c)||c<=0)&&(a.disabled=!0),document.forms["lbcg-view-all-cards-form"].submit(),a.disabled=!1}else if(n.target.matches("div.lbcg-card-col")||n.target.matches("span.lbcg-card-text")||n.target.matches("span.lbcg-card-text img")){let e=n.target;n.target.matches("span.lbcg-card-text")?e=e.parentNode:n.target.matches("span.lbcg-card-text img")&&(e=e.parentNode.parentNode);let t=!1;e.classList.contains("lbcg-card-col-checked")?e.classList.remove("lbcg-card-col-checked"):e.children[0].hasChildNodes()&&(e.classList.add("lbcg-card-col-checked"),t=!0);c=document.getElementById("bc-pn");if(c){const r=JSON.parse(localStorage.getItem("pn-"+c.value))||[],l=parseInt(e.getAttribute("data-key"));isNaN(l)||(r[l]=t),localStorage.setItem("pn-"+c.value,JSON.stringify(r))}}else if(n.target.matches("span.lbcg-sidebar-arrow")){const o=n.target.parentNode.parentNode;o.classList.contains("collapsed")?o.classList.remove("collapsed"):o.classList.add("collapsed")}else(n.target.matches(".lbcg-card-preview-hover")||n.target.matches(".lbcg-card-preview-hover-text"))&&n.target.parentNode.remove()}),document.addEventListener("input",function(t){if(t.target.matches("#lbcg-title"))document.querySelector("div.lbcg-card-header span.lbcg-card-header-text").innerHTML=t.target.value;else if(t.target.matches("#lbcg-body-content")){toggleLoading(!0);var n=s();const c=t.target.value.split("\n"),a=document.querySelectorAll("div.lbcg-card-body-grid span.lbcg-card-text"),r=document.getElementById("lbcg-free-space-check").checked;for(let e=1,t=1;e<=a.length;t++)Math.round(a.length/2)===e&&r?(a[e-1].innerHTML=LBCG.freeSquareWord,e++):(""!==n||void 0!==c[t-1]&&""!==c[t-1])&&(a[e-1].innerHTML=void 0===c[t-1]?"":c[t-1],e++);checkGridFontSize()}else if(t.target.matches("#lbcg-subtitle")){const l=""!==t.target.value?t.target.value.split(""):[];let e="";switch(l.length){case 4:case 3:e="<span></span>";break;case 2:case 1:e="<span></span><span></span>"}document.getElementsByClassName("lbcg-card-subtitle-text")[0].innerHTML=e+(l.length?"<span>"+l.join("</span><span>")+"</span>":"")+e}}),document.addEventListener("change",function(t){if(t.target.matches("#lbcg-grid-size")){const c=document.getElementById("lbcg-free-space-check");"4x4"===t.target.value?(window.LBCIncludeFreeSpace=c.checked,c.checked=!1,c.parentNode.style.display="none"):(c.checked=window.LBCIncludeFreeSpace,c.parentNode.style.display="");let e;e=document.getElementById("lbcg-wrap-words-check").checked?1:"1-90"===document.getElementsByName("bingo_card_type")[0].value?"33.3px":"3x3"===t.target.value?"102px":"4x4"===t.target.value?"76.25px":"60.8px";const a=document.getElementById("content-items-count");a&&(a.innerText="3x3"===t.target.value?9:"4x4"===t.target.value?16:25);const r=document.getElementsByName("bingo_grid_size")[0];r&&(r.value=t.target.value),document.documentElement.style.setProperty("--lbcg-grid-line-height",e),function(){var n=s(),e=document.getElementById("lbcg-grid-size").value[0],c=document.getElementById("lbcg-body-content").value.split("\n"),a=document.getElementById("lbcg-free-space-check").checked,r=e**2;let l="";for(let e=1,t=1;e<=r;t++)(""!==n||void 0!==c[t-1]&&""!==c[t-1])&&(l+='<div class="lbcg-card-col"><span class="lbcg-card-text">'+(Math.round(r/2)===e&&a?LBCG.freeSquareWord:void 0===c[t-1]?"":c[t-1])+"</span></div>",e++);const t=document.querySelector("div.lbcg-card-body-grid"),o=Math.sqrt(document.querySelectorAll("div.lbcg-card-body-grid span.lbcg-card-text").length);t.classList.remove("lbcg-grid-"+o),t.classList.add("lbcg-grid-"+e),t.innerHTML=l}(),checkGridFontSize()}else if(t.target.matches("#lbcg-font"))document.documentElement.style.setProperty("--lbcg-header-font-family",LBCG.fonts[t.target.value].name+", sans-serif"),document.documentElement.style.setProperty("--lbcg-grid-font-family",LBCG.fonts[t.target.value].name+", sans-serif"),checkGridFontSize();else if(t.target.matches("#lbcg-free-space-check"))!function(e){const t=document.querySelectorAll("div.lbcg-card-body-grid span.lbcg-card-text"),n=Math.round(t.length/2)-1;e?(t[n].innerHTML=LBCG.freeSquareWord,t[n].parentNode.classList.add("lbcg-free-space")):(e=document.getElementById("lbcg-body-content").value.split("\n"),t[n].innerHTML="1-75"===document.getElementsByName("bingo_card_type")[0].value?33:e[n],t[n].parentNode.classList.remove("lbcg-free-space"))}(t.target.checked);else if(t.target.matches("#lbcg-cards-custom-count")){var n=parseInt(t.target.value);document.getElementById("lbcg-cards-count").disabled=0<n}else if(t.target.matches("#lbcg-wrap-words-check")){let e;e=t.target.checked?1:(n=document.getElementById("lbcg-grid-size").value,"1-90"===document.getElementsByName("bingo_card_type")[0].value?"33.3px":"3x3"===n?"102px":"4x4"===n?"76.25px":"60.8px"),document.documentElement.style.setProperty("--lbcg-grid-line-height",e),checkGridFontSize()}else t.target.matches("#lbcg-even-distribution-check")&&(t.target.checked?setEvenDistributionContent()&&(document.getElementById("lbcg-cards-words-content").style.display="none",document.getElementById("lbcg-even-distribution-content").style.display="flex"):setWordsFromEvenDistributionContent()&&(document.getElementById("lbcg-even-distribution-content").style.display="none",document.getElementById("lbcg-cards-words-content").style.display="flex"))}),document.addEventListener("submit",function(n){if(n.target.matches("#lbcg-bc-generation")){n.preventDefault();const c=[...document.querySelectorAll('#lbcg-bc-generation button[type="submit"]')];c.forEach(e=>e.disabled=!0),[...document.getElementsByClassName("lbcg-card-col-checked")].forEach(e=>e.classList.remove("lbcg-card-col-checked")),html2canvas(document.getElementsByClassName("lbcg-card")[0]).then(function(e){document.getElementsByName("bc_thumbnail")[0].value=e.toDataURL(),toggleLoading(!0),c.forEach(e=>e.disabled=!1);e=s();if(""!==e)return alert(e),!1;e=new FormData(n.target);const t=new XMLHttpRequest;t.onreadystatechange=function(){if(4===t.readyState&&200===t.status){const e=JSON.parse(t.responseText);!0===e.success?location.replace(e.redirectTo):(alert(e.errors.join("\n")),toggleLoading(!1))}},t.open(n.target.method,LBCG.ajaxUrl,!0),t.send(e)})}else if(n.target.matches("#lbcg-bc-invitation")){n.preventDefault();const a=document.querySelector('#lbcg-bc-invitation button[type="submit"]');a.disabled=!0,[...document.getElementsByClassName("lbcg-card-col-checked")].forEach(e=>e.classList.remove("lbcg-card-col-checked")),html2canvas(document.getElementsByClassName("lbcg-card")[0]).then(function(e){document.getElementsByName("bingo_card_thumb")[0].value=e.toDataURL(),toggleLoading(!0),a.disabled=!1;e=new FormData(n.target);const t=new XMLHttpRequest;t.onreadystatechange=function(){if(4===t.readyState&&200===t.status){const e=JSON.parse(t.responseText);!0===e.success?0<e.failedInvites.length?alert("Invitation finished. Failed to invite them: "+e.failedInvites.join(", ")+"."):alert("Invitation finished successfully."):alert(e.errors.join("\n")),toggleLoading(!1)}},t.open(n.target.method,LBCG.ajaxUrl,!0),t.send(e)})}}),document.addEventListener("change",function(e){var t,n,c,a;e.target.matches(".bc-font-color")?(t=e.target.getAttribute("data-bct"),document.documentElement.style.setProperty("--lbcg-"+t+"-text-color",e.target.value)):e.target.matches(".bc-border-color")?(t=e.target.getAttribute("data-bct"),document.documentElement.style.setProperty("--lbcg-"+t+"-border-color",e.target.value)):e.target.matches(".bc-color")?(n=e.target.getAttribute("data-bct"),document.documentElement.style.setProperty("--lbcg-"+n+"-bg-color",e.target.value)):e.target.matches(".bc-image")?(n=e.target.getAttribute("data-bct"),document.getElementsByName("bc_"+n+"[remove_image]")[0].value="0",document.documentElement.style.setProperty("--lbcg-"+n+"-bg-image","url("+URL.createObjectURL(e.target.files[0])+")")):e.target.matches(".bc-pos")?(c=e.target.getAttribute("data-bct"),document.documentElement.style.setProperty("--lbcg-"+c+"-bg-pos",e.target.value)):e.target.matches(".bc-repeat")?(c=e.target.getAttribute("data-bct"),document.documentElement.style.setProperty("--lbcg-"+c+"-bg-repeat",e.target.value)):e.target.matches(".bc-size")?(a=e.target.getAttribute("data-bct"),document.documentElement.style.setProperty("--lbcg-"+a+"-bg-size",e.target.value)):e.target.matches(".bc-opacity")&&(a=e.target.getAttribute("data-bct"),document.documentElement.style.setProperty("--lbcg-"+a+"-bg-opacity",e.target.value/100))}),addEventsForWordsPercentsInputs()});