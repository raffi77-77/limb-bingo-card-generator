document.addEventListener("DOMContentLoaded",function(){function i(n,l="",e=!1,t="",a="",c=""){const s=new XMLHttpRequest;s.onreadystatechange=function(){if(4===s.readyState&&200===s.status){document.getElementsByClassName("lbcg-card")[0].innerHTML=s.responseText;let e;var t;e=document.getElementById("lbcg-wrap-words-check").checked?1:"1-90"===n?"33.3px":"3x3"===l?"102px":"4x4"===l?"76.25px":"60.8px",document.documentElement.style.setProperty("--lbcg-grid-line-height",e),"1-75"!==n&&"1-90"!==n?checkGridFontSize():(t="1-90"!==n&&"1-75"===n?31.5:16,document.documentElement.style.setProperty("--lbcg-grid-font-size",t+"px"),document.getElementsByName("lbcg_font_size")[0].value=t),toggleLoading(!1)}},s.open("post",LBCG.ajaxUrl,!0);let d=new FormData;d.append("action","lbcg_get_card_content"),d.append("card_type",n),d.append("card_grid_size",l),d.append("free_square",e?"true":"false"),d.append("card_title",t),d.append("spec_title",a),d.append("card_content",c),s.send(d)}function d(){let e=document.getElementById("lbcg-body-content");const t=e.value.split("\n"),n=document.getElementsByName("bingo_grid_size")[0].value,l=document.getElementById("lbcg-bc-type").value;if("1-75"===l||"1-90"===l)return!0;let a=25;return"3x3"===n?a=9:"4x4"===n&&(a=16),t.filter(e=>""!==e).length<a?!(e.style.border="2px solid #b32d2e"):(e.style.border="1px solid #8c8f94",!0)}document.getElementById("lbcg-body-content")&&document.getElementById("lbcg-body-content").addEventListener("input",d),document.addEventListener("change",function(t){if(t.target.matches("#bc-custom-css")){t.preventDefault();let e=document.getElementById("lbcg-custom-css");if(null===e){e=document.createElement("style"),e.setAttribute("id","lbcg-custom-css"),e.setAttribute("type","text/css");const n=document.head||document.getElementsByTagName("head")[0];n.appendChild(e)}e.styleSheet?e.styleSheet.cssText=t.target.value:e.innerHTML=t.target.value}else if(t.target.matches("#lbcg-bc-type")){t.preventDefault(),toggleLoading(!0);const e=document.getElementById("lbcg-title").value,l=document.getElementById("lbcg-grid-size"),a=document.getElementsByName("bingo_grid_size")[0],c=document.getElementById("lbcg-subtitle"),s=document.getElementById("lbcg-body-content"),d=document.getElementById("lbcg-wrap-words-check"),o=document.getElementById("lbcg-free-space-check");switch(t.target.value){case"1-75":a.value="5x5",l.parentNode.style.display="none",c.parentNode.style.display="flex",s.parentNode.style.display="none",d.parentNode.style.display="none",o.parentNode.style.display="flex",i("1-75","5x5",o.checked,e,c.value);break;case"1-90":a.value="9x3",l.parentNode.style.display="none",c.parentNode.style.display="none",s.parentNode.style.display="none",d.parentNode.style.display="none",i("1-90","9x3",!(o.parentNode.style.display="none"),e);break;case"generic":a.value="3x3",l.value="3x3",l.parentNode.style.display="flex",c.parentNode.style.display="none",s.parentNode.style.display="flex",d.parentNode.style.display="flex",o.parentNode.style.display="flex",document.getElementById("content-items-count").innerText=9,i("generic","3x3",o.checked,e,"",s.value)}}}),document.addEventListener("click",function(t){if(t.target.matches("#publish")){const n=document.getElementById("lbcg-bc-type").value,l=document.getElementsByName("bingo_card_thumbnail")[0];n.length?d()?""===l.value&&(t.preventDefault(),t.target.classList.add("disabled"),document.querySelector("#publishing-action span.spinner").classList.add("is-active"),document.getElementsByClassName("lbcg-parent")[0].classList.remove("lbcg-loading"),[...document.getElementsByClassName("lbcg-card-col-checked")].forEach(e=>e.classList.remove("lbcg-card-col-checked")),html2canvas(document.getElementsByClassName("lbcg-card")[0]).then(function(e){l.value=e.toDataURL(),t.target.classList.remove("disabled"),t.target.click()})):(t.preventDefault(),alert("Please provide a minimum words/emojis or numbers quantity.")):(t.preventDefault(),alert("Please select bingo card type before save the post."))}else if(t.target.matches(".bc-image-admin")){t.preventDefault();const a=t.target.getAttribute("data-bct"),c=wp.media({title:"Insert image",library:{type:"image"},button:{text:"Use this image"},multiple:!1}).on("select",function(){var e=c.state().get("selection").first().toJSON();document.getElementById("bc-"+a+"-image").value=e.id,document.documentElement.style.setProperty("--lbcg-"+a+"-bg-image","url("+e.url+")")}).open()}else if(t.target.matches(".remove-bc-image-admin")){t.preventDefault();var e=t.target.getAttribute("data-bct");document.getElementById("bc-"+e+"-image").value="",document.documentElement.style.setProperty("--lbcg-"+e+"-bg-image","none")}else if(t.target.matches("#lbcg-uc-image-set")){const s=wp.media({title:"Insert image",library:{type:"image"},button:{text:"Use this image"},multiple:!1}).on("select",function(){var e=s.state().get("selection").first().toJSON();document.getElementById("lbcg-uc-image").value=e.id;const t=document.getElementById("lbcg-uc-img");t.style.display="",t.setAttribute("src",e.sizes.thumbnail.url)}).open()}else t.target.matches("#lbcg-uc-image-remove")&&(document.getElementById("lbcg-uc-image").value="",document.getElementById("lbcg-uc-img").style.display="none")},!1)},!1);