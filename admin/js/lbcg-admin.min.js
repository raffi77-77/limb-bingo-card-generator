document.addEventListener("DOMContentLoaded",function(){function i(n,a="",e=!1,t="",l="",c=""){const d=new XMLHttpRequest;d.onreadystatechange=function(){if(4===d.readyState&&200===d.status){document.getElementsByClassName("lbcg-card")[0].innerHTML=d.responseText;let e;var t;e=document.getElementById("lbcg-wrap-words-check").checked?1:"1-90"===n?"33.3px":"3x3"===a?"102px":"4x4"===a?"76.25px":"60.8px",document.documentElement.style.setProperty("--lbcg-grid-line-height",e),"1-75"!==n&&"1-90"!==n?checkGridFontSize():(t="1-90"!==n&&"1-75"===n?31.5:16,document.documentElement.style.setProperty("--lbcg-grid-font-size",t+"px"),document.getElementsByName("lbcg_font_size")[0].value=t),toggleLoading(!1)}},d.open("post",LBCG.ajaxUrl,!0);let s=new FormData;s.append("action","lbcg_get_card_content"),s.append("card_type",n),s.append("card_grid_size",a),s.append("free_square",e?"true":"false"),s.append("card_title",t),s.append("spec_title",l),s.append("card_content",c),d.send(s)}function s(){let e=document.getElementById("lbcg-body-content");const t=e.value.split("\n"),n=document.getElementsByName("bingo_grid_size")[0].value,a=document.getElementById("lbcg-bc-type").value;if("1-75"===a||"1-90"===a)return!0;let l=25;return"3x3"===n?l=9:"4x4"===n&&(l=16),t.filter(e=>""!==e).length<l?!(e.style.border="2px solid #b32d2e"):(e.style.border="1px solid #8c8f94",!0)}document.getElementById("lbcg-body-content")&&document.getElementById("lbcg-body-content").addEventListener("input",s),document.addEventListener("change",function(e){if(e.target.matches("#bc-custom-css")){e.preventDefault();const t=document.head||document.getElementsByTagName("head")[0];t.innerHTML=t.innerHTML+e.target.value}else if(e.target.matches("#lbcg-bc-type")){e.preventDefault(),toggleLoading(!0);const n=document.getElementById("lbcg-title").value,a=document.getElementById("lbcg-grid-size"),l=document.getElementsByName("bingo_grid_size")[0],c=document.getElementById("lbcg-subtitle"),d=document.getElementById("lbcg-body-content"),s=document.getElementById("lbcg-wrap-words-check"),o=document.getElementById("lbcg-free-space-check");switch(e.target.value){case"1-75":l.value="5x5",a.parentNode.style.display="none",c.parentNode.style.display="flex",d.parentNode.style.display="none",s.parentNode.style.display="none",o.parentNode.style.display="flex",i("1-75","5x5",o.checked,n,c.value);break;case"1-90":l.value="9x3",a.parentNode.style.display="none",c.parentNode.style.display="none",d.parentNode.style.display="none",s.parentNode.style.display="none",i("1-90","9x3",!(o.parentNode.style.display="none"),n);break;case"generic":l.value="3x3",a.value="3x3",a.parentNode.style.display="flex",c.parentNode.style.display="none",d.parentNode.style.display="flex",s.parentNode.style.display="flex",o.parentNode.style.display="flex",document.getElementById("content-items-count").innerText=9,i("generic","3x3",o.checked,n,"",d.value)}}}),document.addEventListener("click",function(t){if(t.target.matches("#publish")){const n=document.getElementById("lbcg-bc-type").value,a=document.getElementsByName("bingo_card_thumbnail")[0];n.length?s()?""===a.value&&(t.preventDefault(),t.target.classList.add("disabled"),document.querySelector("#publishing-action span.spinner").classList.add("is-active"),document.getElementsByClassName("lbcg-parent")[0].classList.remove("lbcg-loading"),[...document.getElementsByClassName("lbcg-card-col-checked")].forEach(e=>e.classList.remove("lbcg-card-col-checked")),html2canvas(document.getElementsByClassName("lbcg-card")[0]).then(function(e){a.value=e.toDataURL("image/webp"),t.target.classList.remove("disabled"),t.target.click()})):(t.preventDefault(),alert("Please provide a minimum words/emojis or numbers quantity.")):(t.preventDefault(),alert("Please select bingo card type before save the post."))}else if(t.target.matches(".bc-image-admin")){t.preventDefault();const l=t.target.getAttribute("data-bct"),c=wp.media({title:"Insert image",library:{type:"image"},button:{text:"Use this image"},multiple:!1}).on("select",function(){var e=c.state().get("selection").first().toJSON();document.getElementById("bc-"+l+"-image").value=e.id,document.documentElement.style.setProperty("--lbcg-"+l+"-bg-image","url("+e.url+")")}).open()}else if(t.target.matches(".remove-bc-image-admin")){t.preventDefault();var e=t.target.getAttribute("data-bct");document.getElementById("bc-"+e+"-image").value="",document.documentElement.style.setProperty("--lbcg-"+e+"-bg-image","none")}else if(t.target.matches("#lbcg-uc-image-set")){const d=wp.media({title:"Insert image",library:{type:"image"},button:{text:"Use this image"},multiple:!1}).on("select",function(){var e=d.state().get("selection").first().toJSON();document.getElementById("lbcg-uc-image").value=e.id;const t=document.getElementById("lbcg-uc-img");t.style.display="",t.setAttribute("src",e.sizes.thumbnail.url)}).open()}else t.target.matches("#lbcg-uc-image-remove")&&(document.getElementById("lbcg-uc-image").value="",document.getElementById("lbcg-uc-img").style.display="none")},!1)},!1);